{"ast":null,"code":"import fetchJwks from '../runtime/fetch_jwks.js';\nimport { JWKSNoMatchingKey } from '../util/errors.js';\nimport { createLocalJWKSet } from './local.js';\nimport isObject from '../lib/is_object.js';\nfunction isCloudflareWorkers() {\n  return typeof WebSocketPair !== 'undefined' || typeof navigator !== 'undefined' && navigator.userAgent === 'Cloudflare-Workers' || typeof EdgeRuntime !== 'undefined' && EdgeRuntime === 'vercel';\n}\nlet USER_AGENT;\nif (typeof navigator === 'undefined' || !navigator.userAgent?.startsWith?.('Mozilla/5.0 ')) {\n  const NAME = 'jose';\n  const VERSION = 'v5.9.6';\n  USER_AGENT = `${NAME}/${VERSION}`;\n}\nexport const jwksCache = Symbol();\nfunction isFreshJwksCache(input, cacheMaxAge) {\n  if (typeof input !== 'object' || input === null) {\n    return false;\n  }\n  if (!('uat' in input) || typeof input.uat !== 'number' || Date.now() - input.uat >= cacheMaxAge) {\n    return false;\n  }\n  if (!('jwks' in input) || !isObject(input.jwks) || !Array.isArray(input.jwks.keys) || !Array.prototype.every.call(input.jwks.keys, isObject)) {\n    return false;\n  }\n  return true;\n}\nclass RemoteJWKSet {\n  constructor(url, options) {\n    if (!(url instanceof URL)) {\n      throw new TypeError('url must be an instance of URL');\n    }\n    this._url = new URL(url.href);\n    this._options = {\n      agent: options?.agent,\n      headers: options?.headers\n    };\n    this._timeoutDuration = typeof options?.timeoutDuration === 'number' ? options?.timeoutDuration : 5000;\n    this._cooldownDuration = typeof options?.cooldownDuration === 'number' ? options?.cooldownDuration : 30000;\n    this._cacheMaxAge = typeof options?.cacheMaxAge === 'number' ? options?.cacheMaxAge : 600000;\n    if (options?.[jwksCache] !== undefined) {\n      this._cache = options?.[jwksCache];\n      if (isFreshJwksCache(options?.[jwksCache], this._cacheMaxAge)) {\n        this._jwksTimestamp = this._cache.uat;\n        this._local = createLocalJWKSet(this._cache.jwks);\n      }\n    }\n  }\n  coolingDown() {\n    return typeof this._jwksTimestamp === 'number' ? Date.now() < this._jwksTimestamp + this._cooldownDuration : false;\n  }\n  fresh() {\n    return typeof this._jwksTimestamp === 'number' ? Date.now() < this._jwksTimestamp + this._cacheMaxAge : false;\n  }\n  async getKey(protectedHeader, token) {\n    if (!this._local || !this.fresh()) {\n      await this.reload();\n    }\n    try {\n      return await this._local(protectedHeader, token);\n    } catch (err) {\n      if (err instanceof JWKSNoMatchingKey) {\n        if (this.coolingDown() === false) {\n          await this.reload();\n          return this._local(protectedHeader, token);\n        }\n      }\n      throw err;\n    }\n  }\n  async reload() {\n    if (this._pendingFetch && isCloudflareWorkers()) {\n      this._pendingFetch = undefined;\n    }\n    const headers = new Headers(this._options.headers);\n    if (USER_AGENT && !headers.has('User-Agent')) {\n      headers.set('User-Agent', USER_AGENT);\n      this._options.headers = Object.fromEntries(headers.entries());\n    }\n    this._pendingFetch || (this._pendingFetch = fetchJwks(this._url, this._timeoutDuration, this._options).then(json => {\n      this._local = createLocalJWKSet(json);\n      if (this._cache) {\n        this._cache.uat = Date.now();\n        this._cache.jwks = json;\n      }\n      this._jwksTimestamp = Date.now();\n      this._pendingFetch = undefined;\n    }).catch(err => {\n      this._pendingFetch = undefined;\n      throw err;\n    }));\n    await this._pendingFetch;\n  }\n}\nexport function createRemoteJWKSet(url, options) {\n  const set = new RemoteJWKSet(url, options);\n  const remoteJWKSet = async (protectedHeader, token) => set.getKey(protectedHeader, token);\n  Object.defineProperties(remoteJWKSet, {\n    coolingDown: {\n      get: () => set.coolingDown(),\n      enumerable: true,\n      configurable: false\n    },\n    fresh: {\n      get: () => set.fresh(),\n      enumerable: true,\n      configurable: false\n    },\n    reload: {\n      value: () => set.reload(),\n      enumerable: true,\n      configurable: false,\n      writable: false\n    },\n    reloading: {\n      get: () => !!set._pendingFetch,\n      enumerable: true,\n      configurable: false\n    },\n    jwks: {\n      value: () => set._local?.jwks(),\n      enumerable: true,\n      configurable: false,\n      writable: false\n    }\n  });\n  return remoteJWKSet;\n}\nexport const experimental_jwksCache = jwksCache;","map":{"version":3,"names":["fetchJwks","JWKSNoMatchingKey","createLocalJWKSet","isObject","isCloudflareWorkers","WebSocketPair","navigator","userAgent","EdgeRuntime","USER_AGENT","startsWith","NAME","VERSION","jwksCache","Symbol","isFreshJwksCache","input","cacheMaxAge","uat","Date","now","jwks","Array","isArray","keys","prototype","every","call","RemoteJWKSet","constructor","url","options","URL","TypeError","_url","href","_options","agent","headers","_timeoutDuration","timeoutDuration","_cooldownDuration","cooldownDuration","_cacheMaxAge","undefined","_cache","_jwksTimestamp","_local","coolingDown","fresh","getKey","protectedHeader","token","reload","err","_pendingFetch","Headers","has","set","Object","fromEntries","entries","then","json","catch","createRemoteJWKSet","remoteJWKSet","defineProperties","get","enumerable","configurable","value","writable","reloading","experimental_jwksCache"],"sources":["/home/kishan/TheAlterOffice/frontend/node_modules/jose/dist/browser/jwks/remote.js"],"sourcesContent":["import fetchJwks from '../runtime/fetch_jwks.js';\nimport { JWKSNoMatchingKey } from '../util/errors.js';\nimport { createLocalJWKSet } from './local.js';\nimport isObject from '../lib/is_object.js';\nfunction isCloudflareWorkers() {\n    return (typeof WebSocketPair !== 'undefined' ||\n        (typeof navigator !== 'undefined' && navigator.userAgent === 'Cloudflare-Workers') ||\n        (typeof EdgeRuntime !== 'undefined' && EdgeRuntime === 'vercel'));\n}\nlet USER_AGENT;\nif (typeof navigator === 'undefined' || !navigator.userAgent?.startsWith?.('Mozilla/5.0 ')) {\n    const NAME = 'jose';\n    const VERSION = 'v5.9.6';\n    USER_AGENT = `${NAME}/${VERSION}`;\n}\nexport const jwksCache = Symbol();\nfunction isFreshJwksCache(input, cacheMaxAge) {\n    if (typeof input !== 'object' || input === null) {\n        return false;\n    }\n    if (!('uat' in input) || typeof input.uat !== 'number' || Date.now() - input.uat >= cacheMaxAge) {\n        return false;\n    }\n    if (!('jwks' in input) ||\n        !isObject(input.jwks) ||\n        !Array.isArray(input.jwks.keys) ||\n        !Array.prototype.every.call(input.jwks.keys, isObject)) {\n        return false;\n    }\n    return true;\n}\nclass RemoteJWKSet {\n    constructor(url, options) {\n        if (!(url instanceof URL)) {\n            throw new TypeError('url must be an instance of URL');\n        }\n        this._url = new URL(url.href);\n        this._options = { agent: options?.agent, headers: options?.headers };\n        this._timeoutDuration =\n            typeof options?.timeoutDuration === 'number' ? options?.timeoutDuration : 5000;\n        this._cooldownDuration =\n            typeof options?.cooldownDuration === 'number' ? options?.cooldownDuration : 30000;\n        this._cacheMaxAge = typeof options?.cacheMaxAge === 'number' ? options?.cacheMaxAge : 600000;\n        if (options?.[jwksCache] !== undefined) {\n            this._cache = options?.[jwksCache];\n            if (isFreshJwksCache(options?.[jwksCache], this._cacheMaxAge)) {\n                this._jwksTimestamp = this._cache.uat;\n                this._local = createLocalJWKSet(this._cache.jwks);\n            }\n        }\n    }\n    coolingDown() {\n        return typeof this._jwksTimestamp === 'number'\n            ? Date.now() < this._jwksTimestamp + this._cooldownDuration\n            : false;\n    }\n    fresh() {\n        return typeof this._jwksTimestamp === 'number'\n            ? Date.now() < this._jwksTimestamp + this._cacheMaxAge\n            : false;\n    }\n    async getKey(protectedHeader, token) {\n        if (!this._local || !this.fresh()) {\n            await this.reload();\n        }\n        try {\n            return await this._local(protectedHeader, token);\n        }\n        catch (err) {\n            if (err instanceof JWKSNoMatchingKey) {\n                if (this.coolingDown() === false) {\n                    await this.reload();\n                    return this._local(protectedHeader, token);\n                }\n            }\n            throw err;\n        }\n    }\n    async reload() {\n        if (this._pendingFetch && isCloudflareWorkers()) {\n            this._pendingFetch = undefined;\n        }\n        const headers = new Headers(this._options.headers);\n        if (USER_AGENT && !headers.has('User-Agent')) {\n            headers.set('User-Agent', USER_AGENT);\n            this._options.headers = Object.fromEntries(headers.entries());\n        }\n        this._pendingFetch || (this._pendingFetch = fetchJwks(this._url, this._timeoutDuration, this._options)\n            .then((json) => {\n            this._local = createLocalJWKSet(json);\n            if (this._cache) {\n                this._cache.uat = Date.now();\n                this._cache.jwks = json;\n            }\n            this._jwksTimestamp = Date.now();\n            this._pendingFetch = undefined;\n        })\n            .catch((err) => {\n            this._pendingFetch = undefined;\n            throw err;\n        }));\n        await this._pendingFetch;\n    }\n}\nexport function createRemoteJWKSet(url, options) {\n    const set = new RemoteJWKSet(url, options);\n    const remoteJWKSet = async (protectedHeader, token) => set.getKey(protectedHeader, token);\n    Object.defineProperties(remoteJWKSet, {\n        coolingDown: {\n            get: () => set.coolingDown(),\n            enumerable: true,\n            configurable: false,\n        },\n        fresh: {\n            get: () => set.fresh(),\n            enumerable: true,\n            configurable: false,\n        },\n        reload: {\n            value: () => set.reload(),\n            enumerable: true,\n            configurable: false,\n            writable: false,\n        },\n        reloading: {\n            get: () => !!set._pendingFetch,\n            enumerable: true,\n            configurable: false,\n        },\n        jwks: {\n            value: () => set._local?.jwks(),\n            enumerable: true,\n            configurable: false,\n            writable: false,\n        },\n    });\n    return remoteJWKSet;\n}\nexport const experimental_jwksCache = jwksCache;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}